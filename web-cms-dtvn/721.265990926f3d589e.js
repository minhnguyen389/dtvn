(self.webpackChunkweb_cms_dtvn=self.webpackChunkweb_cms_dtvn||[]).push([[721],{9563:(W,H,u)=>{"use strict";u.d(H,{t:()=>w});var E=u(520),Z=u(2340),t=u(5e3);let w=(()=>{class d{constructor(x){this.http=x}getList(x,p,f){let m=new E.LE;return m=m.append("limit",p),m=m.append("offset",f),x&&(m=m.append("name",x)),this.http.get(`${Z.N.url.BASE_URL}/project`,{params:m})}getDetail(x){return this.http.get(`${Z.N.url.BASE_URL}/project/${x}`)}create(x,p,f,m){let C=new E.LE;return C=C.append("name",x),C=C.append("code",f),p&&(C=C.append("description",p)),m&&m.length&&m.forEach(l=>{C=C.append("partners[]",l)}),this.http.post(`${Z.N.url.BASE_URL}/project`,C)}edit(x,p,f,m,C){let l=new E.LE;return p&&(l=l.append("name",p)),m&&(l=l.append("code",m)),f&&(l=l.append("description",f)),C&&C.length?C.forEach(D=>{l=l.append("partners[]",D)}):l=l.append("partners[]",""),this.http.put(`${Z.N.url.BASE_URL}/project/${x}`,l)}delete(x){return this.http.delete(`${Z.N.url.BASE_URL}/project/${x}`)}addFiles(x,p){const f=new FormData;for(const m of p)f.append("files",m);return this.http.put(`${Z.N.url.BASE_URL}/project/${x}/add_files`,f)}addPhotos(x,p){const f=new FormData;for(const m of p)f.append("files",m);return this.http.put(`${Z.N.url.BASE_URL}/project/${x}/add_photos`,f)}deleteFile(x,p){let f=new E.LE;return p&&(f=f.append("file",p)),this.http.put(`${Z.N.url.BASE_URL}/project/${x}/delete_file`,f)}deletePhoto(x,p){let f=new E.LE;return p&&(f=f.append("photo",p)),this.http.put(`${Z.N.url.BASE_URL}/project/${x}/delete_photo`,f)}}return d.\u0275fac=function(x){return new(x||d)(t.LFG(E.eN))},d.\u0275prov=t.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},6675:(W,H,u)=>{"use strict";u.d(H,{I:()=>d,Q:()=>S});var E=u(1764),Z=u.n(E),t=u(5268),w=u.n(t);Z().extend(w());class d{static isoToVnTime(p){return p&&0!==p.length?Z().utc(p).local().format("DD/MM/YYYY HH:mm:ss"):"N/A"}}class S{static toDigis(p,f){if(p)return p.toLocaleString("en-us",{minimumFractionDigits:f,maximumFractionDigits:f});if(0==p){let m="";for(let C=0;C<f;C++)m+="0";return f?`0.${m}`:"0"}return"---"}static ascii2Hex(p){let f=[];for(let m=0,C=p.length;m<C;m++){let l=Number(p.charCodeAt(m));f.push(l)}return f}static hex2Ascii(p){let f="";for(let m=0;m<p.length;m+=1)f+=String.fromCharCode(p[m]);return f}}},6721:(W,H,u)=>{"use strict";u.r(H),u.d(H,{ProjectModule:()=>Ot});var E=u(9808),Z=u(8753),t=u(5e3),w=u(6675),d=u(2382),S=u(8215),x=u(5330),p=u(9563),f=u(9783),m=u(845),C=u(5787),l=u(1424),D=u(3407),N=u(2537),J=u(6526);function I(n,c){1&n&&(t.TgZ(0,"div"),t._uU(1," *C\u1ea7n \u0111i\u1ec1n t\xean C\xf4ng ty."),t.qZA())}function V(n,c){1&n&&(t.TgZ(0,"div"),t._uU(1," *T\xean C\xf4ng ty d\xe0i \xedt nh\u1ea5t 2 k\xfd t\u1ef1."),t.qZA())}function U(n,c){if(1&n&&(t.TgZ(0,"small",20),t.YNc(1,I,2,0,"div",21),t.YNc(2,V,2,0,"div",21),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.formGroup.controls.name.invalid),t.xp6(1),t.Q6J("ngIf",e.formGroup.controls.name.errors.minlength)}}function F(n,c){1&n&&(t.TgZ(0,"div"),t._uU(1," *C\u1ea7n \u0111i\u1ec1n m\xe3 qu\u1ea3n l\xfd C\xf4ng tr\xecnh."),t.qZA())}function k(n,c){if(1&n&&(t.TgZ(0,"small",20),t.YNc(1,F,2,0,"div",21),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.formGroup.controls.code.invalid)}}let R=(()=>{class n{constructor(e,i,o,T,$){this.ref=e,this.config=i,this.formBuilder=o,this.pHttpService=T,this.messageService=$,this.title="Th\xeam m\u1edbi c\xf4ng tr\xecnh",this.partnerOption=S.o.partnerOption}ngOnInit(){this.formGroup=this.formBuilder.group({name:["",[d.kI.required,d.kI.minLength(2)]],description:[""],code:["",[d.kI.required]],partner:[""]}),this.config.data&&(this.project=this.config.data.project,this.title=this.config.data.title,this.formGroup.setValue({name:this.project.name,description:this.project.description?this.project.description:"",code:this.project.code,partner:this.project.partners}))}onSubmit(){this.project?this.onEdit():this.onAdd()}onAdd(){this.pHttpService.create(this.formGroup.value.name,this.formGroup.value.description,this.formGroup.value.code,this.formGroup.value.partner).subscribe({next:e=>{e&&200===e.status&&(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 t\u1ea1o c\xf4ng tr\xecnh th\xe0nh c\xf4ng"}),this.ref.close("success"))},error:e=>{let i;i=e&&e.error&&e.error.message?e.error.message:"C\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i!",this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:i}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e)}})}onEdit(){this.pHttpService.edit(this.project._id,this.formGroup.value.name,this.formGroup.value.description,this.formGroup.value.code,this.formGroup.value.partner).subscribe({next:e=>{e&&200===e.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 c\u1eadp nh\u1eadt c\xf4ng tr\xecnh th\xe0nh c\xf4ng"}),this.ref.close("success")):(this.messageService.add({severity:"warn",summary:"C\u1ea3nh b\xe1o",detail:"Kh\xf4ng t\xecm th\u1ea5y c\xf4ng tr\xecnh"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e.message))},error:e=>{let i;i=e&&e.error&&e.error.message?e.error.message:"C\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i!",this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:i}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e)}})}onDestroy(){this.ref.destroy()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.E7),t.Y36(x.S),t.Y36(d.qu),t.Y36(p.t),t.Y36(f.ez))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-creat-or-edit-project"]],decls:33,vars:6,consts:[[3,"formGroup","ngSubmit"],[1,"outbound"],[1,"header","flex","align-items-center","justify-content-between","border-bottom-1","border-gray-300"],[1,"ml-2","text-xl","font-bold"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-danger","p-button-text",3,"click"],[1,"content"],[1,"p-fluid","m-2"],[1,"field","mb-3"],["for","name"],[1,"ml-2","text-red-500"],["id","name","type","text","pInputText","","formControlName","name"],["class","text-red-500",4,"ngIf"],["for","des"],["id","des","pInputTextarea","","formControlName","description"],["for","code"],["id","cod","mask","*****","formControlName","code","characterPattern","[0-9]"],["formControlName","partner","defaultLabel","Ch\u1ecdn \u0110\u01a1n v\u1ecb nh\u1eadn d\u1eef li\u1ec7u","optionLabel","name","optionValue","value",3,"options"],[1,"footer","flex","align-items-center","justify-content-end","border-top-1","border-gray-300"],["pButton","","pRipple","","type","button","label","H\u1ee7y b\u1ecf","icon","fa-solid fa-times",1,"p-button-outlined","mr-1",3,"click"],["pButton","","pRipple","","type","submit","label","L\u01b0u th\xf4ng tin","icon","fa-solid fa-floppy-disk",1,"mr-1",3,"disabled"],[1,"text-red-500"],[4,"ngIf"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return i.onSubmit()}),t.TgZ(1,"div",1)(2,"div",2)(3,"span",3),t._uU(4),t.qZA(),t.TgZ(5,"button",4),t.NdJ("click",function(){return i.onDestroy()}),t.qZA()(),t.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"label",8),t._uU(10,"T\xean"),t.TgZ(11,"span",9),t._uU(12,"(*)"),t.qZA()(),t._UZ(13,"input",10),t.YNc(14,U,3,2,"small",11),t.qZA(),t.TgZ(15,"div",7)(16,"label",12),t._uU(17,"M\xf4 t\u1ea3"),t.qZA(),t._UZ(18,"textarea",13),t.qZA(),t.TgZ(19,"div",7)(20,"label",14),t._uU(21,"M\xe3 qu\u1ea3n l\xfd"),t.TgZ(22,"span",9),t._uU(23,"(*)"),t.qZA()(),t._UZ(24,"p-inputMask",15),t.YNc(25,k,2,1,"small",11),t.qZA(),t.TgZ(26,"div",7)(27,"label"),t._uU(28," \u0110\u01a1n v\u1ecb nh\u1eadn d\u1eef li\u1ec7u"),t.qZA(),t._UZ(29,"p-multiSelect",16),t.qZA()()(),t.TgZ(30,"div",17)(31,"button",18),t.NdJ("click",function(){return i.onDestroy()}),t.qZA(),t._UZ(32,"button",19),t.qZA()()()),2&e&&(t.Q6J("formGroup",i.formGroup),t.xp6(4),t.Oqu(i.title),t.xp6(10),t.Q6J("ngIf",i.formGroup.controls.name.invalid&&i.formGroup.controls.name.touched),t.xp6(11),t.Q6J("ngIf",i.formGroup.controls.code.invalid&&i.formGroup.controls.code.touched),t.xp6(4),t.Q6J("options",i.partnerOption),t.xp6(3),t.Q6J("disabled",i.formGroup.invalid))},directives:[d._Y,d.JL,d.sg,m.Hq,C.H,d.Fj,l.o,d.JJ,d.u,E.O5,D.g,N.vy,J.NU],styles:[".outbound[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;overflow:hidden}.outbound[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:45px}.outbound[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:absolute;top:45px;bottom:45px;left:0;width:100%;overflow:auto}.outbound[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;bottom:0;height:45px;left:0;width:100%}"]}),n})();var j=u(5431),y=u(3542),B=u(8952);function et(n,c){1&n&&(t.TgZ(0,"tr")(1,"th",4),t._uU(2,"#"),t.qZA(),t.TgZ(3,"th",5),t._uU(4,"Th\xf4ng tin"),t.qZA(),t.TgZ(5,"th",5),t._uU(6,"Chi ti\u1ebft"),t.qZA()())}function g(n,c){if(1&n&&(t.TgZ(0,"tr")(1,"td",4),t._uU(2),t.qZA(),t.TgZ(3,"td",5),t._uU(4),t.qZA(),t.TgZ(5,"td",5),t._uU(6),t.qZA()()),2&n){const e=c.$implicit,i=c.rowIndex;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(e.key),t.xp6(2),t.Oqu(e.value)}}let a=(()=>{class n{constructor(){this.characteristics=[],this.totalItems=0}ngOnInit(){this.getCharacteristics()}getCharacteristics(){this.totalItems=0;for(const e in this.project)"name"==e?(this.characteristics[this.totalItems]={key:"T\xean",value:this.project[e]},this.totalItems+=1):"description"==e?(this.characteristics[this.totalItems]={key:"M\xf4 t\u1ea3",value:this.project[e]},this.totalItems+=1):"code"==e?(this.characteristics[this.totalItems]={key:"M\xe3 qu\u1ea3n l\xfd",value:this.project[e]},this.totalItems+=1):"partners"==e?(this.characteristics[this.totalItems]={key:"\u0110\u1ed1i t\xe1c nh\u1eadn d\u1eef li\u1ec7u",value:this.project[e]},this.totalItems+=1):"created_at"==e?(this.characteristics[this.totalItems]={key:"Th\u1eddi gian t\u1ea1o",value:this.convertTime(this.project[e])},this.totalItems+=1):"updated_at"==e&&(this.characteristics[this.totalItems]={key:"C\u1eadp nh\u1eadt",value:this.convertTime(this.project[e])},this.totalItems+=1)}convertTime(e){return w.I.isoToVnTime(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-project-info"]],inputs:{project:"project"},decls:4,vars:2,consts:[[1,"absolute","top-0","left-0","bottom-0","right-0"],["styleClass","p-datatable-sm p-datatable-striped","scrollHeight","flex",3,"value","scrollable"],["pTemplate","header"],["pTemplate","body"],[2,"width","60px","max-width","60px"],[2,"min-width","200px"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"p-table",1),t.YNc(2,et,7,0,"ng-template",2),t.YNc(3,g,7,3,"ng-template",3),t.qZA()()),2&e&&(t.xp6(1),t.Q6J("value",i.characteristics)("scrollable",!0))},directives:[B.iA,f.jx],styles:[""]}),n})();var s=u(2340),h=u(9269),r=u(4119);const v=["divBound"],_=["divTable"],b=["divPaginator"],M=["fileUploader"];function P(n,c){1&n&&(t.TgZ(0,"tr")(1,"th",15),t._uU(2,"#"),t.qZA(),t.TgZ(3,"th",16),t._uU(4,"Danh s\xe1ch t\xe0i li\u1ec7u"),t.qZA(),t.TgZ(5,"th",17),t._uU(6,"Thao t\xe1c"),t.qZA()())}function A(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td",15),t._uU(2),t.qZA(),t.TgZ(3,"td",16),t._uU(4),t.qZA(),t.TgZ(5,"td",17)(6,"button",18),t.NdJ("click",function(){const T=t.CHM(e).$implicit;return t.oxw().onDownload(T)}),t.qZA(),t.TgZ(7,"button",19),t.NdJ("click",function(){const T=t.CHM(e).$implicit;return t.oxw().onDeleteFile(T)}),t.qZA()()()}if(2&n){const e=c.$implicit,i=c.rowIndex,o=t.oxw();t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(e),t.xp6(3),t.Q6J("disabled",!o.permission.project.update_files)}}function Y(n,c){1&n&&(t.TgZ(0,"div",20),t._uU(1," Kh\xf4ng c\xf3 d\u1eef li\u1ec7u trong m\u1ee5c n\xe0y. "),t.qZA())}let q=(()=>{class n{constructor(e,i,o,T,$,X){this.pHttpService=e,this.messageService=i,this.dialogService=o,this.renderer=T,this.confirmService=$,this.permissionService=X,this.files=[],this.max_file_size=1048576*S.o.MAX_FILE_SIZE_MB,this.fileLists=[],this.loading=!1}ngAfterViewChecked(){this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight}px`)}ngOnDestroy(){this.loadingTime&&clearTimeout(this.loadingTime),this.subPermission&&this.subPermission.unsubscribe()}ngOnInit(){this.subPermission=this.permissionService.currentPermission.subscribe(e=>{e&&(this.permission=e)}),this.fetchInfo()}fetchInfo(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.pHttpService.getDetail(this.project._id).subscribe({next:e=>{e&&200===e.status?(this.project=e.metadata,this.fileLists=this.project.files,this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)):this.messageService.add({severity:"warn",summary:"C\u1ea3nh b\xe1o",detail:"Kh\xf4ng t\xecm th\u1ea5y c\xf4ng tr\xecnh"})},error:e=>{let i;i=e&&e.error&&e.error.message?e.error.message:"C\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i!",this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:i}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}onDownload(e){window.open(s.N.url.FILE_URL+e)}onAttachFile(e){if(this.files=[],e.target.files.length>0){for(const i of e.target.files)/\.(jpe?g|png|doc|docx|xls|xlsx|pdf|dwg|rar|zip)$/i.test(i.name)&&i.size<=this.max_file_size?this.files.push(i):this.messageService.add({severity:"warn",summary:"C\u1ea3nh b\xe1o",detail:`File "${i.name}" kh\xf4ng ph\xf9 h\u1ee3p \u0111\u1ecbnh d\u1ea1ng jpg|jpeg|png|doc|docx|xls|xlsx|pdf|dwg|rar|zip ho\u1eb7c file l\u1edbn h\u01a1n ${S.o.MAX_FILE_SIZE_MB}MB`});this.onAddFileToProject(),this.fileUploader.nativeElement.value=""}}onAddFileToProject(){!this.files||!this.files.length||this.pHttpService.addFiles(this.project._id,this.files).subscribe({next:e=>{e&&200===e.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 th\xeam file th\xe0nh c\xf4ng!"}),this.fetchInfo()):(this.messageService.add({severity:"warn",summary:"C\u1ea3nh b\xe1o",detail:"Kh\xf4ng t\xecm th\u1ea5y c\xf4ng tr\xecnh"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e.message))},error:e=>{let i;i=e&&e.error&&e.error.message?e.error.message:"C\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i!",this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:i}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e)}})}onDeleteFile(e){this.confirmService.confirm({message:`B\u1ea1n c\xf3 mu\u1ed1n x\xf3a file "${e}" kh\xf4ng?`,header:"X\xe1c nh\u1eadn x\xf3a file",icon:"pi pi-info-circle"}).then(i=>{i&&this.pHttpService.deleteFile(this.project._id,e).subscribe({next:o=>{o&&200===o.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 x\xf3a file th\xe0nh c\xf4ng!"}),this.fetchInfo()):(this.messageService.add({severity:"warn",summary:"C\u1ea3nh b\xe1o",detail:"Kh\xf4ng t\xecm th\u1ea5y c\xf4ng tr\xecnh ho\u1eb7c file"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",o.message))},error:o=>{let T;T=o&&o.error&&o.error.message?o.error.message:"C\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i!",this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:T}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",o)}})}).catch(i=>{})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.t),t.Y36(f.ez),t.Y36(x.xA),t.Y36(t.Qsj),t.Y36(h.I),t.Y36(j.$))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-project-file"]],viewQuery:function(e,i){if(1&e&&(t.Gf(v,5,t.SBq),t.Gf(_,5,t.SBq),t.Gf(b,5,t.SBq),t.Gf(M,5,t.SBq)),2&e){let o;t.iGM(o=t.CRH())&&(i.divBound=o.first),t.iGM(o=t.CRH())&&(i.divTable=o.first),t.iGM(o=t.CRH())&&(i.divPaginator=o.first),t.iGM(o=t.CRH())&&(i.fileUploader=o.first)}},inputs:{project:"project"},decls:15,vars:3,consts:[[1,"absolute","top-0","left-0","bottom-0","right-0"],["divBound",""],[1,"absolute","top-0","left-0","w-full","overflow-auto"],["divTable",""],["styleClass","p-datatable-sm p-datatable-striped","scrollHeight","flex",3,"value","scrollable"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"absolute","bottom-0","left-0","p-1","w-full","border-top-1","border-gray-300"],["divPaginator",""],[1,"grid","grid-nogutter"],[1,"col-12","flex","align-items-center"],["type","file","multiple","","accept",".doc, .docx, .xls, .xlsx, .pdf, .dwg, .rar, .zip",2,"display","none",3,"change"],["fileUploader",""],["pButton","","pRipple","","type","button","label","Th\xeam file","icon","fa-solid fa-plus",1,"mr-1",3,"disabled","click"],[2,"width","60px","max-width","60px"],[2,"min-width","250px"],[2,"width","150px","max-width","150px"],["pButton","","pRipple","","type","button","icon","pi pi-cloud-download","pTooltip","T\u1ea3i v\u1ec1","tooltipPosition","top",1,"p-button-outlined","mr-1",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-times","pTooltip","X\xf3a file","tooltipPosition","top",1,"p-button-outlined","mr-1",3,"disabled","click"],[1,"p-fluid","pr-2"]],template:function(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"div",0,1)(2,"div",2,3)(4,"p-table",4),t.YNc(5,P,7,0,"ng-template",5),t.YNc(6,A,8,3,"ng-template",6),t.YNc(7,Y,2,0,"ng-template",7),t.qZA()(),t.TgZ(8,"div",8,9)(10,"div",10)(11,"div",11)(12,"input",12,13),t.NdJ("change",function($){return i.onAttachFile($)}),t.qZA(),t.TgZ(14,"button",14),t.NdJ("click",function(){return t.CHM(o),t.MAs(13).click()}),t.qZA()()()()()}2&e&&(t.xp6(4),t.Q6J("value",i.fileLists)("scrollable",!0),t.xp6(10),t.Q6J("disabled",!i.permission.project.update_files))},directives:[B.iA,f.jx,m.Hq,C.H,r.u],styles:[""]}),n})();var G=u(3037);const z=["divBound"],Q=["divTable"],O=["divPaginator"],L=["fileUploader"];function tt(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",14)(1,"img",15),t.NdJ("click",function(){const T=t.CHM(e).$implicit;return t.oxw().onViewPhoto(T)})("contextmenu",function(o){const $=t.CHM(e).$implicit;return t.oxw().onContextMenu(o,$),!1}),t.qZA()()}if(2&n){const e=c.$implicit,i=t.oxw();t.xp6(1),t.Q6J("src",i.getPath(e),t.LSH)}}const K=function(n,c,e){return{display:n,"top.px":c,"left.px":e}};function nt(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",16)(1,"div",17),t.NdJ("click",function(){return t.CHM(e),t.oxw().onDeleteFile()}),t._uU(2,"X\xf3a \u1ea3nh "),t.qZA(),t.TgZ(3,"div",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().onClose()}),t._uU(4,"\u0110\xf3ng"),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("ngStyle",t.kEZ(1,K,e.hasContextMenu?"block":"none",e.top_menu,e.left_menu))}}let ot=(()=>{class n{constructor(e,i,o,T,$,X){this.pHttpService=e,this.messageService=i,this.dialogService=o,this.renderer=T,this.confirmService=$,this.permissionService=X,this.files=[],this.max_file_size=1048576*S.o.MAX_FILE_SIZE_MB,this.photoLists=[],this.loading=!1,this.hasContextMenu=!1,this.top_menu=0,this.left_menu=0}ngAfterViewChecked(){this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight}px`)}ngOnDestroy(){this.loadingTime&&clearTimeout(this.loadingTime),this.subPermission&&this.subPermission.unsubscribe()}ngOnInit(){this.subPermission=this.permissionService.currentPermission.subscribe(e=>{e&&(this.permission=e)}),this.fetchInfo()}fetchInfo(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.pHttpService.getDetail(this.project._id).subscribe({next:e=>{e&&200===e.status?(this.project=e.metadata,this.photoLists=this.project.photos,this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime),this.currentFile=null):(this.messageService.add({severity:"warn",summary:"C\u1ea3nh b\xe1o",detail:"Kh\xf4ng t\xecm th\u1ea5y c\xf4ng tr\xecnh"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e.message))},error:e=>{let i;i=e&&e.error&&e.error.message?e.error.message:"C\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i!",this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:i}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}onDownload(e){window.open(s.N.url.FILE_URL+e)}onAttachFile(e){if(this.files=[],e.target.files.length>0){for(const i of e.target.files)/\.(jpe?g|png|doc|docx|xls|xlsx|pdf|dwg)$/i.test(i.name)&&i.size<=this.max_file_size?this.files.push(i):this.messageService.add({severity:"warn",summary:"C\u1ea3nh b\xe1o",detail:`File "${i.name}" kh\xf4ng ph\xf9 h\u1ee3p \u0111\u1ecbnh d\u1ea1ng jpg|jpeg|png|doc|docx|xls|xlsx|pdf|dwg ho\u1eb7c file l\u1edbn h\u01a1n ${S.o.MAX_FILE_SIZE_MB}MB`});this.onAddFileToProject(),this.fileUploader.nativeElement.value=""}}onAddFileToProject(){!this.files||!this.files.length||this.pHttpService.addPhotos(this.project._id,this.files).subscribe({next:e=>{e&&e&&200===e.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 th\xeam \u1ea3nh th\xe0nh c\xf4ng!"}),this.fetchInfo()):(this.messageService.add({severity:"warn",summary:"C\u1ea3nh b\xe1o",detail:"Kh\xf4ng t\xecm th\u1ea5y c\xf4ng tr\xecnh"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e.message))},error:e=>{let i;i=e&&e.error&&e.error.message?e.error.message:"C\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i!",this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:i}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e)}})}onDeleteFile(){this.hasContextMenu=!1,this.confirmService.confirm({message:`B\u1ea1n c\xf3 mu\u1ed1n x\xf3a \u1ea3nh "${this.currentFile}" kh\xf4ng?`,header:"X\xe1c nh\u1eadn x\xf3a \u1ea3nh",icon:"pi pi-info-circle"}).then(e=>{e&&this.pHttpService.deletePhoto(this.project._id,this.currentFile).subscribe({next:i=>{i&&200===i.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 x\xf3a \u1ea3nh th\xe0nh c\xf4ng!"}),this.fetchInfo()):this.messageService.add({severity:"warn",summary:"C\u1ea3nh b\xe1o",detail:"Kh\xf4ng t\xecm th\u1ea5y c\xf4ng tr\xecnh ho\u1eb7c file"})},error:i=>{let o;o=i&&i.error&&i.error.message?i.error.message:"C\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i!",this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:o}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}).catch(e=>{})}onClose(){this.currentFile=null,this.hasContextMenu=!1}onContextMenu(e,i){this.hasContextMenu=!0,this.top_menu=e.clientY-42,this.left_menu=e.clientX-8,this.currentFile=i}getPath(e){return"assets/placeholder.png"}onViewPhoto(e){this.dialogService.open(G.p,{data:{photo:e},showHeader:!1,height:"99vh",width:"99vw",contentStyle:{padding:"0",margin:0}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.t),t.Y36(f.ez),t.Y36(x.xA),t.Y36(t.Qsj),t.Y36(h.I),t.Y36(j.$))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-project-photo"]],viewQuery:function(e,i){if(1&e&&(t.Gf(z,5,t.SBq),t.Gf(Q,5,t.SBq),t.Gf(O,5,t.SBq),t.Gf(L,5,t.SBq)),2&e){let o;t.iGM(o=t.CRH())&&(i.divBound=o.first),t.iGM(o=t.CRH())&&(i.divTable=o.first),t.iGM(o=t.CRH())&&(i.divPaginator=o.first),t.iGM(o=t.CRH())&&(i.fileUploader=o.first)}},inputs:{project:"project"},decls:14,vars:3,consts:[[1,"absolute","top-0","left-0","bottom-0","right-0"],["divBound",""],[1,"absolute","top-0","left-0","w-full","overflow-auto"],["divTable",""],[1,"flex","flex-wrap","gap-2","p-2"],["class","flex align-items-center justify-content-center","style","height: 150px;",4,"ngFor","ngForOf"],["class","ctmenu border-1 border-gray-300 p-0 surface-0","style","width: 130px;",3,"ngStyle",4,"ngIf"],[1,"absolute","bottom-0","left-0","p-1","w-full","border-top-1","border-gray-300"],["divPaginator",""],[1,"grid","grid-nogutter"],[1,"col-12","flex","align-items-center"],["type","file","multiple","","accept",".jpg, .jpeg, .png",2,"display","none",3,"change"],["fileUploader",""],["pButton","","pRipple","","type","button","label","Th\xeam \u1ea3nh","icon","fa-solid fa-plus",1,"mr-1",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center",2,"height","150px"],["alt","construction photo",1,"pointer","shadow-4",2,"height","100%",3,"src","click","contextmenu"],[1,"ctmenu","border-1","border-gray-300","p-0","surface-0",2,"width","130px",3,"ngStyle"],[1,"border-bottom-1","border-gray-300","p-1","text-center","pointer","btn",3,"click"],[1,"p-1","text-center","pointer","btn",3,"click"]],template:function(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"div",0,1)(2,"div",2,3)(4,"div",4),t.YNc(5,tt,2,1,"div",5),t.qZA(),t.YNc(6,nt,5,5,"div",6),t.qZA(),t.TgZ(7,"div",7,8)(9,"div",9)(10,"div",10)(11,"input",11,12),t.NdJ("change",function($){return i.onAttachFile($)}),t.qZA(),t.TgZ(13,"button",13),t.NdJ("click",function(){return t.CHM(o),t.MAs(12).click()}),t.qZA()()()()()}2&e&&(t.xp6(5),t.Q6J("ngForOf",i.photoLists),t.xp6(1),t.Q6J("ngIf",i.permission.project.update_files),t.xp6(7),t.Q6J("disabled",!i.permission.project.update_files))},directives:[E.sg,E.O5,E.PC,m.Hq,C.H],styles:[".pointer[_ngcontent-%COMP%]{cursor:pointer}.ctmenu[_ngcontent-%COMP%]{position:fixed;z-index:200}.btn[_ngcontent-%COMP%]:hover{background-color:#eff6ff}"]}),n})();var it=u(97);const st=["divBound"],rt=["divHeader"],at=["divTable"];function ct(n,c){if(1&n&&t._UZ(0,"app-project-info",13),2&n){const e=t.oxw(2);t.Q6J("project",e.project)}}function lt(n,c){if(1&n&&t._UZ(0,"app-project-file",13),2&n){const e=t.oxw(2);t.Q6J("project",e.project)}}function ut(n,c){if(1&n&&t._UZ(0,"app-project-photo",13),2&n){const e=t.oxw(2);t.Q6J("project",e.project)}}function pt(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",2,3),t.NdJ("resize",function(){return t.CHM(e),t.oxw().onWindowResize()},!1,t.Jf7),t.TgZ(2,"div",4,5)(4,"div",6)(5,"span",7),t._uU(6),t.qZA(),t.TgZ(7,"button",8),t.NdJ("click",function(){return t.CHM(e),t.oxw().onDestroy()}),t.qZA()(),t._UZ(8,"p-tabMenu",9),t.qZA(),t.TgZ(9,"div",10,11),t.YNc(11,ct,1,1,"app-project-info",12),t.YNc(12,lt,1,1,"app-project-file",12),t.YNc(13,ut,1,1,"app-project-photo",12),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(6),t.Oqu(e.title),t.xp6(2),t.Q6J("model",e.tabs)("activeItem",e.activeTab),t.xp6(3),t.Q6J("ngIf",1==e.tabIndex),t.xp6(1),t.Q6J("ngIf",2==e.tabIndex),t.xp6(1),t.Q6J("ngIf",3==e.tabIndex)}}function dt(n,c){1&n&&(t._UZ(0,"i",16),t.TgZ(1,"span",17),t._uU(2,"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp v\xe0o m\u1ee5c n\xe0y!"),t.qZA())}function mt(n,c){1&n&&(t.TgZ(0,"p-messages",14),t.YNc(1,dt,3,0,"ng-template",15),t.qZA())}let ht=(()=>{class n{constructor(e,i,o,T){this.renderer=e,this.permissionService=i,this.ref=o,this.config=T,this.tabIndex=1,this.title="Chi ti\u1ebft c\xf4ng tr\xecnh"}ngOnDestroy(){this.subPermission&&this.subPermission.unsubscribe()}setStyleDiv(){this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divHeader.nativeElement.offsetHeight}px`)}ngAfterViewInit(){this.setStyleDiv()}onWindowResize(){this.setStyleDiv()}ngOnInit(){this.subPermission=this.permissionService.currentPermission.subscribe(e=>{e&&(this.permission=e,this.config.data.project&&(this.project=this.config.data.project),this.initForm())})}initForm(){this.tabs=[{label:"Th\xf4ng tin chung",command:()=>{this.tabIndex=1}},{label:"File h\u1ed3 s\u01a1",command:()=>{this.tabIndex=2}},{label:"\u1ea2nh c\xf4ng tr\xecnh",command:()=>{this.tabIndex=3}}],this.activeTab=this.tabs[0],this.tabIndex=1}onDestroy(){this.ref.destroy()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.Qsj),t.Y36(j.$),t.Y36(x.E7),t.Y36(x.S))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-project-detail"]],viewQuery:function(e,i){if(1&e&&(t.Gf(st,5,t.SBq),t.Gf(rt,5,t.SBq),t.Gf(at,5,t.SBq)),2&e){let o;t.iGM(o=t.CRH())&&(i.divBound=o.first),t.iGM(o=t.CRH())&&(i.divHeader=o.first),t.iGM(o=t.CRH())&&(i.divTable=o.first)}},decls:3,vars:2,consts:[["class","absolute top-0 left-0 bottom-0 right-0",3,"resize",4,"ngIf","ngIfElse"],["noPermission",""],[1,"absolute","top-0","left-0","bottom-0","right-0",3,"resize"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],["divHeader",""],[1,"flex","align-items-center","justify-content-between","border-bottom-1","border-gray-300"],[1,"ml-2","text-xl","font-bold"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-danger","p-button-text",3,"click"],[3,"model","activeItem"],[1,"absolute","bottom-0","left-0","w-full"],["divTable",""],[3,"project",4,"ngIf"],[3,"project"],["severity","error"],["pTemplate",""],[1,"pi","pi-times-circle"],[1,"ml-2"]],template:function(e,i){if(1&e&&(t.YNc(0,pt,14,6,"div",0),t.YNc(1,mt,2,0,"ng-template",null,1,t.W1O)),2&e){const o=t.MAs(2);t.Q6J("ngIf",i.permission.project.self)("ngIfElse",o)}},directives:[E.O5,m.Hq,C.H,y.d,a,q,ot,it.V,f.jx],styles:[""]}),n})();var ft=u(7658),gt=u(9955),_t=u(4132);const vt=["divBound"],xt=["divTable"],Ct=["divPaginator"];function Tt(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",28)(1,"div",29)(2,"input",30),t.NdJ("ngModelChange",function(o){return t.CHM(e),t.oxw(2).name=o}),t.qZA()(),t.TgZ(3,"div",31)(4,"div",32)(5,"span")(6,"button",33),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).onClear()}),t.qZA(),t.TgZ(7,"button",34),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).fetchListOfProjects()}),t.qZA()()()()()}if(2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("ngModel",e.name)}}function bt(n,c){1&n&&(t.TgZ(0,"tr")(1,"th",35),t._uU(2,"#"),t.qZA(),t.TgZ(3,"th",36),t._uU(4,"T\xean "),t._UZ(5,"p-sortIcon",37),t.qZA(),t.TgZ(6,"th",38),t._uU(7,"M\xf4 t\u1ea3"),t.qZA(),t.TgZ(8,"th",39),t._uU(9,"Code"),t.qZA(),t.TgZ(10,"th",39),t._uU(11,"Partner"),t.qZA(),t.TgZ(12,"th",40),t._uU(13,"Th\u1eddi gian t\u1ea1o "),t._UZ(14,"p-sortIcon",41),t.qZA(),t.TgZ(15,"th",42),t._uU(16,"C\u1eadp nh\u1eadt "),t._UZ(17,"p-sortIcon",43),t.qZA()())}function yt(n,c){if(1&n&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&n){const e=c.$implicit;t.xp6(1),t.Oqu(e)}}function jt(n,c){if(1&n&&(t.TgZ(0,"tr",44)(1,"td",35),t._uU(2),t.qZA(),t.TgZ(3,"td",38),t._uU(4),t.qZA(),t.TgZ(5,"td",38),t._uU(6),t.qZA(),t.TgZ(7,"td",39),t._uU(8),t.qZA(),t.TgZ(9,"td",39)(10,"ul",45),t.YNc(11,yt,2,1,"li",46),t.qZA()(),t.TgZ(12,"td",38),t._uU(13),t.qZA(),t.TgZ(14,"td",38),t._uU(15),t.qZA()()),2&n){const e=c.$implicit,i=c.rowIndex,o=t.oxw(2);t.Q6J("pSelectableRow",e),t.xp6(2),t.Oqu((o.currentPage-1)*o.itemsPerPage+1+i),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.description),t.xp6(2),t.Oqu(e.code),t.xp6(3),t.Q6J("ngForOf",e.partners),t.xp6(2),t.Oqu(o.convertTime(e.created_at)),t.xp6(2),t.Oqu(o.convertTime(e.updated_at))}}function Pt(n,c){1&n&&(t.TgZ(0,"div",47),t._uU(1," Kh\xf4ng c\xf3 d\u1eef li\u1ec7u trong m\u1ee5c n\xe0y. "),t.qZA())}function Et(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"p-splitButton",48),t.NdJ("onClick",function(){return t.CHM(e),t.oxw(2).onViewDetail()}),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("showTransitionOptions","200ms")("hideTransitionOptions","200ms")("model",e.moreCommands)("disabled",!e.currentProject)}}const Mt=function(){return[15,20,30,50]};function Zt(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",2,3),t.NdJ("resize",function(){return t.CHM(e),t.oxw().onWindowResize()},!1,t.Jf7),t.TgZ(2,"div",4),t._UZ(3,"p-breadcrumb",5),t.TgZ(4,"div",6)(5,"h3",7),t._UZ(6,"i",8),t._uU(7,"Danh s\xe1ch c\xf4ng tr\xecnh "),t.qZA()(),t.TgZ(8,"div",9,10)(10,"p-table",11),t.NdJ("selectionChange",function(o){return t.CHM(e),t.oxw().currentProject=o})("onRowSelect",function(o){return t.CHM(e),t.oxw().onRowSelect(o)})("onRowUnselect",function(o){return t.CHM(e),t.oxw().onRowUnselect(o)}),t.YNc(11,Tt,8,1,"ng-template",12),t.YNc(12,bt,18,0,"ng-template",13),t.YNc(13,jt,16,8,"ng-template",14),t.YNc(14,Pt,2,0,"ng-template",15),t.qZA()()(),t.TgZ(15,"div",16,17)(17,"div",18)(18,"div",19)(19,"button",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().onAdd()}),t.qZA(),t.TgZ(20,"button",21),t.NdJ("click",function(){return t.CHM(e),t.oxw().onEdit()}),t.qZA(),t.YNc(21,Et,1,4,"p-splitButton",22),t.qZA(),t.TgZ(22,"div",23)(23,"p-paginator",24),t.NdJ("onPageChange",function(o){return t.CHM(e),t.oxw().onPageChange(o)}),t.qZA()(),t.TgZ(24,"div",25)(25,"button",26),t.NdJ("click",function(){return t.CHM(e),t.oxw().onReSync()}),t.qZA(),t.TgZ(26,"span",27),t._uU(27),t.qZA()()()()()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("model",e.pathLinks)("home",e.homeLink),t.xp6(7),t.Q6J("selection",e.currentProject)("value",e.projects)("scrollable",!0)("loading",e.loading),t.xp6(9),t.Q6J("disabled",!e.permission.project.create),t.xp6(1),t.Q6J("disabled",!e.currentProject||!e.permission.project.edit),t.xp6(1),t.Q6J("ngIf",e.permission.project.self),t.xp6(2),t.Q6J("rows",e.itemsPerPage)("totalRecords",e.totalItems)("rowsPerPageOptions",t.DdM(17,Mt))("showJumpToPageDropdown",!0)("showPageLinks",!1),t.xp6(4),t.lnq("Hi\u1ec3n th\u1ecb ",(e.currentPage-1)*e.itemsPerPage+1,"-",(e.currentPage-1)*e.itemsPerPage+e.itemsPerPage>e.totalItems?e.totalItems:(e.currentPage-1)*e.itemsPerPage+e.itemsPerPage,"/",e.totalItems,"")}}function St(n,c){1&n&&(t._UZ(0,"i",56),t.TgZ(1,"span",57),t._uU(2,"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp v\xe0o m\u1ee5c n\xe0y!"),t.qZA())}function wt(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",49)(1,"p-messages",50),t.YNc(2,St,3,0,"ng-template",51),t.qZA()(),t.TgZ(3,"div",52)(4,"div",53),t.NdJ("click",function(){return t.CHM(e),t.oxw().onGoBackHome()}),t._UZ(5,"span",54),t.TgZ(6,"span",55),t._uU(7,"Quay l\u1ea1i Trang ch\u1ee7"),t.qZA()()()}}const At=[{path:"",component:(()=>{class n{constructor(e,i,o,T,$,X,It){this.pHttpService=e,this.messageService=i,this.renderer=o,this.dialogService=T,this.permissionService=$,this.router=X,this.confirmService=It,this.offset=0,this.totalItems=0,this.itemsPerPage=15,this.currentPage=1,this.projects=[],this.loading=!1}ngOnDestroy(){this.subPermission&&this.subPermission.unsubscribe(),this.loadingTime&&clearTimeout(this.loadingTime)}setStyleDiv(){this.windowWidth=this.divBound.nativeElement.offsetWidth,this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight-62}px`)}ngAfterViewInit(){this.setStyleDiv()}onWindowResize(){this.setStyleDiv()}calcWidth(){let e="";return e=this.windowWidth<450?.99*this.windowWidth+"px":"450px",e}ngOnInit(){this.subPermission=this.permissionService.currentPermission.subscribe(e=>{e&&(this.permission=e,this.initForm(),this.fetchListOfProjects())})}initForm(){this.pathLinks=[{label:"Qu\u1ea3n l\xfd",disabled:!0},{label:"C\xf4ng tr\xecnh",disabled:!0}],this.homeLink={icon:"fa-solid fa-home",routerLink:"/"},this.moreCommands=[{label:"X\xf3a b\u1ecf",icon:"fa-solid fa-minus",disabled:!0,command:()=>{this.onDelete()}}]}onViewDetail(){this.dialogService.open(ht,{data:{project:this.currentProject},showHeader:!1,width:"99vw",height:"99vh",contentStyle:{padding:"0",margin:0}})}onClear(){this.name=null}fetchListOfProjects(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.pHttpService.getList(this.name,this.itemsPerPage,this.offset).subscribe({next:e=>{e&&200===e.status&&(this.projects=e.metadata.docs,this.totalItems=e.metadata.totalDocs,this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime),this.currentProject=null)},error:e=>{let i;i=e&&e.error&&e.error.message?e.error.message:"C\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i!",this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:i}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}onPageChange(e){this.currentPage=e.page+1,this.itemsPerPage=e.rows,this.offset=(this.currentPage-1)*this.itemsPerPage,this.fetchListOfProjects()}onReSync(){this.fetchListOfProjects()}onRowSelect(e){this.moreCommands[0].disabled=!this.permission.project.delete||!this.currentProject}onRowUnselect(e){this.moreCommands[0].disabled=!this.permission.project.delete||!this.currentProject}onAdd(){this.dialogService.open(R,{showHeader:!1,height:"650px",width:this.calcWidth(),contentStyle:{padding:"0",margin:0}}).onClose.subscribe(()=>{this.fetchListOfProjects()})}onEdit(){this.dialogService.open(R,{data:{project:this.currentProject,title:"C\u1eadp nh\u1eadt c\xf4ng tr\xecnh"},showHeader:!1,height:"650px",width:this.calcWidth(),contentStyle:{padding:"0",margin:0}}).onClose.subscribe(()=>{this.fetchListOfProjects()})}onDelete(){this.confirmService.confirm({message:`B\u1ea1n c\xf3 mu\u1ed1n x\xf3a c\xf4ng tr\xecnh "${this.currentProject.name}" kh\xf4ng?`,header:"X\xe1c nh\u1eadn x\xf3a c\xf4ng tr\xecnh",icon:"pi pi-info-circle"}).then(e=>{e&&this.pHttpService.delete(this.currentProject._id).subscribe({next:i=>{i&&200===i.status?(this.fetchListOfProjects(),this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 x\xf3a c\xf4ng tr\xecnh th\xe0nh c\xf4ng"})):(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"Kh\xf4ng t\xecm th\u1ea5y c\xf4ng tr\xecnh"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i.message))},error:i=>{let o;o=i&&i.error&&i.error.message?i.error.message:"C\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i!",this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:o}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i)}})}).catch(e=>{})}convertTime(e){return w.I.isoToVnTime(e)}onGoBackHome(){this.router.navigate(["/"])}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.t),t.Y36(f.ez),t.Y36(t.Qsj),t.Y36(x.xA),t.Y36(j.$),t.Y36(Z.F0),t.Y36(h.I))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-project-management"]],viewQuery:function(e,i){if(1&e&&(t.Gf(vt,5,t.SBq),t.Gf(xt,5,t.SBq),t.Gf(Ct,5,t.SBq)),2&e){let o;t.iGM(o=t.CRH())&&(i.divBound=o.first),t.iGM(o=t.CRH())&&(i.divTable=o.first),t.iGM(o=t.CRH())&&(i.divPaginator=o.first)}},decls:3,vars:2,consts:[["class","relative h-full w-full",3,"resize",4,"ngIf","ngIfElse"],["noPermission",""],[1,"relative","h-full","w-full",3,"resize"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],["styleClass","text-sm p-1",3,"model","home"],[1,"flex","align-items-center"],[1,"text-blue-700","m-0","px-2","pt-2","pb-0"],[1,"fa-solid","fa-list","mr-2"],[1,"page-content","mt-1"],["divTable",""],["selectionMode","single","styleClass","p-datatable-sm p-datatable-striped","scrollHeight","flex",3,"selection","value","scrollable","loading","selectionChange","onRowSelect","onRowUnselect"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"absolute","bottom-0","left-0","p-1","w-full","border-top-1","border-gray-300"],["divPaginator",""],[1,"grid","grid-nogutter"],[1,"col-12","md:col-5","flex","align-items-center"],["pButton","","pRipple","","type","button","label","Th\xeam","icon","fa-solid fa-plus",1,"mr-1",3,"disabled","click"],["pButton","","pRipple","","type","button","label","Ch\u1ec9nh s\u1eeda","icon","fa-solid fa-pen",1,"mr-1",3,"disabled","click"],["label","Chi ti\u1ebft","icon","fa-solid fa-wand-sparkles",3,"showTransitionOptions","hideTransitionOptions","model","disabled","onClick",4,"ngIf"],[1,"col-12","md:col-5","flex","align-items-center","justify-content-end"],["styleClass","p-0",3,"rows","totalRecords","rowsPerPageOptions","showJumpToPageDropdown","showPageLinks","onPageChange"],[1,"col-12","md:col-2","flex","align-items-center"],["pButton","","pRipple","","type","button","icon","fa-solid fa-sync",1,"p-button-raised","p-button-text","m-0","p-1",3,"click"],[1,"ml-1"],[1,"p-fluid","grid","formgrid"],[1,"field","col-12","md:col-3","mb-1"],["type","text","pInputText","","placeholder","Nh\u1eadp t\xean C\xf4ng tr\xecnh",3,"ngModel","ngModelChange"],[1,"field","col-12","md:col-3"],[1,"flex","justify-content-between"],["type","button","pButton","","icon","fa-solid fa-undo","pTooltip","\u0110\u1eb7t l\u1ea1i","tooltipPosition","top",1,"mr-1",3,"click"],["type","button","pButton","","icon","fa-solid fa-search","pTooltip","T\xecm ki\u1ebfm","tooltipPosition","top",1,"mr-1",3,"click"],[2,"width","60px","max-width","60px"],["pSortableColumn","name",2,"min-width","200px"],["field","name"],[2,"min-width","200px"],[2,"min-width","150px"],["pSortableColumn","created_at",2,"min-width","200px"],["field","created_at"],["pSortableColumn","updated_at",2,"min-width","200px"],["field","updated_at"],[3,"pSelectableRow"],[1,"m-0","py-0","pl-3"],[4,"ngFor","ngForOf"],[1,"p-fluid","p-2"],["label","Chi ti\u1ebft","icon","fa-solid fa-wand-sparkles",3,"showTransitionOptions","hideTransitionOptions","model","disabled","onClick"],[1,"flex","align-items-center","justify-content-center"],["severity","error"],["pTemplate",""],[1,"flex","align-items-center","justify-content-center","cursor-pointer"],["pRipple","",1,"flex","align-items-center","justify-content-center","w-full","h-4rem","max-w-20rem","bg-blue-500","border-round-md","shadow-8","text-white","font-bold",3,"click"],[1,"fa-solid","fa-home"],[1,"text-center","text-xl","mx-2"],[1,"pi","pi-times-circle"],[1,"ml-2"]],template:function(e,i){if(1&e&&(t.YNc(0,Zt,28,18,"div",0),t.YNc(1,wt,8,0,"ng-template",null,1,t.W1O)),2&e){const o=t.MAs(2);t.Q6J("ngIf",i.permission.project.self)("ngIfElse",o)}},directives:[E.O5,ft.a,B.iA,f.jx,d.Fj,l.o,d.JJ,d.On,m.Hq,r.u,B.lQ,B.fz,B.Ei,E.sg,C.H,gt.a,_t.D,it.V],styles:[""]}),n})()}];let $t=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[Z.Bz.forChild(At)],Z.Bz]}),n})();var Dt=u(8910);let Ot=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[E.ez,$t,Dt.m]]}),n})()},1764:function(W){W.exports=function(){"use strict";var u=6e4,E=36e5,Z="millisecond",t="second",w="minute",d="hour",S="day",x="week",p="month",f="quarter",m="year",C="date",l="Invalid Date",D=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,N=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,J={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(g){var a=["th","st","nd","rd"],s=g%100;return"["+g+(a[(s-20)%10]||a[s]||a[0])+"]"}},I=function(g,a,s){var h=String(g);return!h||h.length>=a?g:""+Array(a+1-h.length).join(s)+g},V={s:I,z:function(g){var a=-g.utcOffset(),s=Math.abs(a),h=Math.floor(s/60),r=s%60;return(a<=0?"+":"-")+I(h,2,"0")+":"+I(r,2,"0")},m:function g(a,s){if(a.date()<s.date())return-g(s,a);var h=12*(s.year()-a.year())+(s.month()-a.month()),r=a.clone().add(h,p),v=s-r<0,_=a.clone().add(h+(v?-1:1),p);return+(-(h+(s-r)/(v?r-_:_-r))||0)},a:function(g){return g<0?Math.ceil(g)||0:Math.floor(g)},p:function(g){return{M:p,y:m,w:x,d:S,D:C,h:d,m:w,s:t,ms:Z,Q:f}[g]||String(g||"").toLowerCase().replace(/s$/,"")},u:function(g){return void 0===g}},U="en",F={};F[U]=J;var k=function(g){return g instanceof B},R=function g(a,s,h){var r;if(!a)return U;if("string"==typeof a){var v=a.toLowerCase();F[v]&&(r=v),s&&(F[v]=s,r=v);var _=a.split("-");if(!r&&_.length>1)return g(_[0])}else{var b=a.name;F[b]=a,r=b}return!h&&r&&(U=r),r||!h&&U},j=function(g,a){if(k(g))return g.clone();var s="object"==typeof a?a:{};return s.date=g,s.args=arguments,new B(s)},y=V;y.l=R,y.i=k,y.w=function(g,a){return j(g,{locale:a.$L,utc:a.$u,x:a.$x,$offset:a.$offset})};var B=function(){function g(s){this.$L=R(s.locale,null,!0),this.parse(s)}var a=g.prototype;return a.parse=function(s){this.$d=function(h){var r=h.date,v=h.utc;if(null===r)return new Date(NaN);if(y.u(r))return new Date;if(r instanceof Date)return new Date(r);if("string"==typeof r&&!/Z$/i.test(r)){var _=r.match(D);if(_){var b=_[2]-1||0,M=(_[7]||"0").substring(0,3);return v?new Date(Date.UTC(_[1],b,_[3]||1,_[4]||0,_[5]||0,_[6]||0,M)):new Date(_[1],b,_[3]||1,_[4]||0,_[5]||0,_[6]||0,M)}}return new Date(r)}(s),this.$x=s.x||{},this.init()},a.init=function(){var s=this.$d;this.$y=s.getFullYear(),this.$M=s.getMonth(),this.$D=s.getDate(),this.$W=s.getDay(),this.$H=s.getHours(),this.$m=s.getMinutes(),this.$s=s.getSeconds(),this.$ms=s.getMilliseconds()},a.$utils=function(){return y},a.isValid=function(){return this.$d.toString()!==l},a.isSame=function(s,h){var r=j(s);return this.startOf(h)<=r&&r<=this.endOf(h)},a.isAfter=function(s,h){return j(s)<this.startOf(h)},a.isBefore=function(s,h){return this.endOf(h)<j(s)},a.$g=function(s,h,r){return y.u(s)?this[h]:this.set(r,s)},a.unix=function(){return Math.floor(this.valueOf()/1e3)},a.valueOf=function(){return this.$d.getTime()},a.startOf=function(s,h){var r=this,v=!!y.u(h)||h,_=y.p(s),b=function(Q,O){var L=y.w(r.$u?Date.UTC(r.$y,O,Q):new Date(r.$y,O,Q),r);return v?L:L.endOf(S)},M=function(Q,O){return y.w(r.toDate()[Q].apply(r.toDate("s"),(v?[0,0,0,0]:[23,59,59,999]).slice(O)),r)},P=this.$W,A=this.$M,Y=this.$D,q="set"+(this.$u?"UTC":"");switch(_){case m:return v?b(1,0):b(31,11);case p:return v?b(1,A):b(0,A+1);case x:var G=this.$locale().weekStart||0,z=(P<G?P+7:P)-G;return b(v?Y-z:Y+(6-z),A);case S:case C:return M(q+"Hours",0);case d:return M(q+"Minutes",1);case w:return M(q+"Seconds",2);case t:return M(q+"Milliseconds",3);default:return this.clone()}},a.endOf=function(s){return this.startOf(s,!1)},a.$set=function(s,h){var r,v=y.p(s),_="set"+(this.$u?"UTC":""),b=(r={},r[S]=_+"Date",r[C]=_+"Date",r[p]=_+"Month",r[m]=_+"FullYear",r[d]=_+"Hours",r[w]=_+"Minutes",r[t]=_+"Seconds",r[Z]=_+"Milliseconds",r)[v],M=v===S?this.$D+(h-this.$W):h;if(v===p||v===m){var P=this.clone().set(C,1);P.$d[b](M),P.init(),this.$d=P.set(C,Math.min(this.$D,P.daysInMonth())).$d}else b&&this.$d[b](M);return this.init(),this},a.set=function(s,h){return this.clone().$set(s,h)},a.get=function(s){return this[y.p(s)]()},a.add=function(s,h){var r,v=this;s=Number(s);var _=y.p(h),b=function(A){var Y=j(v);return y.w(Y.date(Y.date()+Math.round(A*s)),v)};if(_===p)return this.set(p,this.$M+s);if(_===m)return this.set(m,this.$y+s);if(_===S)return b(1);if(_===x)return b(7);var M=(r={},r[w]=u,r[d]=E,r[t]=1e3,r)[_]||1,P=this.$d.getTime()+s*M;return y.w(P,this)},a.subtract=function(s,h){return this.add(-1*s,h)},a.format=function(s){var h=this,r=this.$locale();if(!this.isValid())return r.invalidDate||l;var v=s||"YYYY-MM-DDTHH:mm:ssZ",_=y.z(this),b=this.$H,M=this.$m,P=this.$M,A=r.weekdays,Y=r.months,q=function(O,L,tt,K){return O&&(O[L]||O(h,v))||tt[L].slice(0,K)},G=function(O){return y.s(b%12||12,O,"0")},z=r.meridiem||function(O,L,tt){var K=O<12?"AM":"PM";return tt?K.toLowerCase():K},Q={YY:String(this.$y).slice(-2),YYYY:this.$y,M:P+1,MM:y.s(P+1,2,"0"),MMM:q(r.monthsShort,P,Y,3),MMMM:q(Y,P),D:this.$D,DD:y.s(this.$D,2,"0"),d:String(this.$W),dd:q(r.weekdaysMin,this.$W,A,2),ddd:q(r.weekdaysShort,this.$W,A,3),dddd:A[this.$W],H:String(b),HH:y.s(b,2,"0"),h:G(1),hh:G(2),a:z(b,M,!0),A:z(b,M,!1),m:String(M),mm:y.s(M,2,"0"),s:String(this.$s),ss:y.s(this.$s,2,"0"),SSS:y.s(this.$ms,3,"0"),Z:_};return v.replace(N,function(O,L){return L||Q[O]||_.replace(":","")})},a.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},a.diff=function(s,h,r){var v,_=y.p(h),b=j(s),M=(b.utcOffset()-this.utcOffset())*u,P=this-b,A=y.m(this,b);return A=(v={},v[m]=A/12,v[p]=A,v[f]=A/3,v[x]=(P-M)/6048e5,v[S]=(P-M)/864e5,v[d]=P/E,v[w]=P/u,v[t]=P/1e3,v)[_]||P,r?A:y.a(A)},a.daysInMonth=function(){return this.endOf(p).$D},a.$locale=function(){return F[this.$L]},a.locale=function(s,h){if(!s)return this.$L;var r=this.clone(),v=R(s,h,!0);return v&&(r.$L=v),r},a.clone=function(){return y.w(this.$d,this)},a.toDate=function(){return new Date(this.valueOf())},a.toJSON=function(){return this.isValid()?this.toISOString():null},a.toISOString=function(){return this.$d.toISOString()},a.toString=function(){return this.$d.toUTCString()},g}(),et=B.prototype;return j.prototype=et,[["$ms",Z],["$s",t],["$m",w],["$H",d],["$W",S],["$M",p],["$y",m],["$D",C]].forEach(function(g){et[g[1]]=function(a){return this.$g(a,g[0],g[1])}}),j.extend=function(g,a){return g.$i||(g(a,B,j),g.$i=!0),j},j.locale=R,j.isDayjs=k,j.unix=function(g){return j(1e3*g)},j.en=F[U],j.Ls=F,j.p={},j}()},5268:function(W){W.exports=function(){"use strict";var H="minute",u=/[+-]\d\d(?::?\d\d)?/g,E=/([+-]|\d\d)/g;return function(Z,t,w){var d=t.prototype;w.utc=function(l){return new t({date:l,utc:!0,args:arguments})},d.utc=function(l){var D=w(this.toDate(),{locale:this.$L,utc:!0});return l?D.add(this.utcOffset(),H):D},d.local=function(){return w(this.toDate(),{locale:this.$L,utc:!1})};var S=d.parse;d.parse=function(l){l.utc&&(this.$u=!0),this.$utils().u(l.$offset)||(this.$offset=l.$offset),S.call(this,l)};var x=d.init;d.init=function(){if(this.$u){var l=this.$d;this.$y=l.getUTCFullYear(),this.$M=l.getUTCMonth(),this.$D=l.getUTCDate(),this.$W=l.getUTCDay(),this.$H=l.getUTCHours(),this.$m=l.getUTCMinutes(),this.$s=l.getUTCSeconds(),this.$ms=l.getUTCMilliseconds()}else x.call(this)};var p=d.utcOffset;d.utcOffset=function(l,D){var N=this.$utils().u;if(N(l))return this.$u?0:N(this.$offset)?p.call(this):this.$offset;if("string"==typeof l&&null===(l=function(U){void 0===U&&(U="");var F=U.match(u);if(!F)return null;var k=(""+F[0]).match(E)||["-",0,0],j=60*+k[1]+ +k[2];return 0===j?0:"+"===k[0]?j:-j}(l)))return this;var J=Math.abs(l)<=16?60*l:l,I=this;if(D)return I.$offset=J,I.$u=0===l,I;if(0!==l){var V=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(I=this.local().add(J+V,H)).$offset=J,I.$x.$localOffset=V}else I=this.utc();return I};var f=d.format;d.format=function(l){return f.call(this,l||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":""))},d.valueOf=function(){var l=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*l},d.isUTC=function(){return!!this.$u},d.toISOString=function(){return this.toDate().toISOString()},d.toString=function(){return this.toDate().toUTCString()};var m=d.toDate;d.toDate=function(l){return"s"===l&&this.$offset?w(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():m.call(this)};var C=d.diff;d.diff=function(l,D,N){if(l&&this.$u===l.$u)return C.call(this,l,D,N);var J=this.local(),I=w(l).local();return C.call(J,I,D,N)}}}()}}]);