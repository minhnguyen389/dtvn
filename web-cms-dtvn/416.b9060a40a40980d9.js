"use strict";(self.webpackChunkweb_cms_dtvn=self.webpackChunkweb_cms_dtvn||[]).push([[416],{1489:(S,A,s)=>{s.d(A,{P:()=>E});var t=s(520),g=s(2340),T=s(5e3);let E=(()=>{class P{constructor(a){this.http=a}getList(a,_,l,u,o,h){let r=new t.LE;return r=r.append("limit",o),r=r.append("offset",h),a&&(r=r.append("name",a)),_&&(r=r.append("code",_)),l&&(r=r.append("project_id",l)),u&&(r=r.append("device_type",u)),this.http.get(`${g.N.url.BASE_URL}/station`,{params:r})}getByLocation(a,_,l,u){let o=new t.LE;return o=o.append("lat_min",a),o=o.append("lat_max",l),o=o.append("long_min",_),o=o.append("long_max",u),this.http.get(`${g.N.url.BASE_URL}/station/by_location`,{params:o})}getAll(){return this.http.get(`${g.N.url.BASE_URL}/station/all`)}getDetail(a){return this.http.get(`${g.N.url.BASE_URL}/station/${a}`)}create(a,_,l,u,o,h,r){let p=new t.LE;return p=p.append("name",a),p=p.append("code",l),p=p.append("device_type",r),p=p.append("project_id",u),_&&(p=p.append("description",_)),(null!=o||null!=o)&&(p=p.append("latitude",o)),(null!=h||null!=h)&&(p=p.append("longitude",h)),this.http.post(`${g.N.url.BASE_URL}/station`,p)}edit(a,_,l,u,o,h,r,p,C){let c=new t.LE;return _&&(c=c.append("name",_)),l&&(c=c.append("description",l)),(null!=u||null!=u)&&(c=c.append("latitude",u)),(null!=o||null!=o)&&(c=c.append("longitude",o)),h&&(c=c.append("code",h)),r&&(c=c.append("gateway",r)),C&&(c=c.append("tcp_server_ip",C)),(null!=p||null!=p)&&(c=c.append("en_display",p)),this.http.put(`${g.N.url.BASE_URL}/station/${a}`,c)}delete(a){return this.http.delete(`${g.N.url.BASE_URL}/station/${a}`)}active(a,_){let l=new t.LE;return l=l.append("activated",!!_),this.http.put(`${g.N.url.BASE_URL}/station/${a}/active`,l)}removeClient(a,_){let l=new t.LE;return l=l.append("client_id",_),this.http.put(`${g.N.url.BASE_URL}/station/${a}/remove_client`,l)}downloadConfig(a,_,l,u){let o=new t.LE;return o=o.append("data",_),o=o.append("type",l),o=o.append("mac",u),this.http.put(`${g.N.url.BASE_URL}/station/${a}/download_config`,o)}}return P.\u0275fac=function(a){return new(a||P)(T.LFG(t.eN))},P.\u0275prov=T.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})()},4416:(S,A,s)=>{s.d(A,{L:()=>x});var t=s(5e3),g=s(535),T=s(8215),E=s(5330),P=s(1489),v=s(9783),a=s(845),_=s(5787),l=s(8952),u=s(2382),o=s(1424),h=s(4119),r=s(9808),p=s(4132);const C=["divBound"],c=["divTable"],b=["divPaginator"];function M(d,f){if(1&d){const n=t.EpF();t.TgZ(0,"div",24)(1,"div",25)(2,"div",26)(3,"input",27),t.NdJ("ngModelChange",function(i){return t.CHM(n),t.oxw().project_name=i}),t.qZA(),t.TgZ(4,"button",28),t.NdJ("click",function(){return t.CHM(n),t.oxw().onPickProject()}),t.qZA()()(),t.TgZ(5,"div",25)(6,"input",29),t.NdJ("ngModelChange",function(i){return t.CHM(n),t.oxw().name=i}),t.qZA()(),t.TgZ(7,"div",25)(8,"input",30),t.NdJ("ngModelChange",function(i){return t.CHM(n),t.oxw().code=i}),t.qZA()(),t.TgZ(9,"div",31)(10,"div",32)(11,"span")(12,"button",33),t.NdJ("click",function(){return t.CHM(n),t.oxw().onClear()}),t.qZA(),t.TgZ(13,"button",34),t.NdJ("click",function(){return t.CHM(n),t.oxw().fetchListOfStations()}),t.qZA()()()()()}if(2&d){const n=t.oxw();t.xp6(3),t.Q6J("ngModel",n.project_name),t.xp6(3),t.Q6J("ngModel",n.name),t.xp6(2),t.Q6J("ngModel",n.code)}}function y(d,f){1&d&&(t.TgZ(0,"tr")(1,"th",35),t._uU(2,"#"),t.qZA(),t.TgZ(3,"th",36),t._uU(4,"T\xean "),t._UZ(5,"p-sortIcon",37),t.qZA(),t.TgZ(6,"th",38),t._uU(7,"M\xe3"),t.qZA(),t.TgZ(8,"th",39),t._uU(9,"Lo\u1ea1i"),t.qZA(),t.TgZ(10,"th",40),t._uU(11,"K\xedch ho\u1ea1t"),t.qZA(),t.TgZ(12,"th",41),t._uU(13,"C\xf4ng tr\xecnh"),t.qZA()())}function Z(d,f){1&d&&t._UZ(0,"i",45)}function O(d,f){if(1&d&&(t.TgZ(0,"tr",42)(1,"td",35),t._uU(2),t.qZA(),t.TgZ(3,"td",41),t._uU(4),t.qZA(),t.TgZ(5,"td",38),t._uU(6),t.qZA(),t.TgZ(7,"td",39),t._uU(8),t.qZA(),t.TgZ(9,"td",43),t.YNc(10,Z,1,0,"i",44),t.qZA(),t.TgZ(11,"td",41),t._uU(12),t.qZA()()),2&d){const n=f.$implicit,e=f.rowIndex,i=t.oxw();t.Q6J("pSelectableRow",n),t.xp6(2),t.Oqu((i.currentPage-1)*i.itemsPerPage+1+e),t.xp6(2),t.Oqu(n.name),t.xp6(2),t.Oqu(n.code),t.xp6(2),t.Oqu(i.getDeviceType(n.device_type)),t.xp6(2),t.Q6J("ngIf",n.activated),t.xp6(2),t.Oqu(null==n.project?null:n.project.name)}}function D(d,f){1&d&&(t.TgZ(0,"div",46),t._uU(1," Kh\xf4ng c\xf3 d\u1eef li\u1ec7u trong m\u1ee5c n\xe0y. "),t.qZA())}const L=function(){return[15,20,30,50]};let x=(()=>{class d{constructor(n,e,i,m,B,k){this.ref=n,this.config=e,this.sHttpService=i,this.messageService=m,this.renderer=B,this.dialogService=k,this.title="Ch\u1ecdn tr\u1ea1m",this.deviceTypeOption=T.o.deviceTypeOption,this.offset=0,this.totalItems=0,this.itemsPerPage=15,this.currentPage=1,this.stations=[],this.loading=!1}ngOnDestroy(){this.loadingTime&&clearTimeout(this.loadingTime)}ngAfterViewInit(){this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight-40}px`)}onWindowResize(){this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight-40}px`)}ngOnInit(){this.fetchListOfStations()}onPickProject(){this.dialogService.open(g.A,{showHeader:!1,width:"99vw",height:"99vh",contentStyle:{padding:"0",margin:0}}).onClose.subscribe(e=>{e&&(this.project_name=e.name,this.project_id=e._id)})}onClear(){this.name=null,this.code=null,this.project_id=null,this.project_name=null}fetchListOfStations(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.sHttpService.getList(this.name,this.code,this.project_id,null,this.itemsPerPage,this.offset).subscribe({next:n=>{n&&200===n.status&&(this.stations=n.metadata.docs,this.totalItems=n.metadata.totalDocs,this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime),this.currentStation=null)},error:n=>{let e;e=n&&n.error&&n.error.message?n.error.message:"C\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i!",this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:e}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",n),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}onPageChange(n){this.currentPage=n.page+1,this.itemsPerPage=n.rows,this.offset=(this.currentPage-1)*this.itemsPerPage,this.fetchListOfStations()}onReSync(){this.fetchListOfStations()}onSubmit(){this.ref.close(this.currentStation)}onDestroy(){this.ref.destroy()}getDeviceType(n){let e=this.deviceTypeOption.find(i=>i.value==n);return e?e.name:n}}return d.\u0275fac=function(n){return new(n||d)(t.Y36(E.E7),t.Y36(E.S),t.Y36(P.P),t.Y36(v.ez),t.Y36(t.Qsj),t.Y36(E.xA))},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-pick-station"]],viewQuery:function(n,e){if(1&n&&(t.Gf(C,5,t.SBq),t.Gf(c,5,t.SBq),t.Gf(b,5,t.SBq)),2&n){let i;t.iGM(i=t.CRH())&&(e.divBound=i.first),t.iGM(i=t.CRH())&&(e.divTable=i.first),t.iGM(i=t.CRH())&&(e.divPaginator=i.first)}},decls:26,vars:15,consts:[[1,"absolute","top-0","left-0","bottom-0","right-0",3,"resize"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],[1,"flex","align-items-center","justify-content-between","border-bottom-1","border-gray-300"],[1,"ml-2","text-xl","font-bold"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-danger","p-button-text",3,"click"],[1,"page-content","mt-1"],["divTable",""],["selectionMode","single","styleClass","p-datatable-sm p-datatable-striped","scrollHeight","flex",3,"selection","value","scrollable","loading","selectionChange"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"absolute","bottom-0","left-0","w-full","p-1","border-top-1","border-gray-300"],["divPaginator",""],[1,"grid","grid-nogutter"],[1,"col-12","md:col-5","flex","align-items-center"],["pButton","","pRipple","","type","button","label","Ch\u1ecdn","icon","fa-solid fa-check",1,"mr-1",3,"disabled","click"],["pButton","","pRipple","","type","button","label","H\u1ee7y b\u1ecf","icon","fa-solid fa-times",1,"p-button-outlined","mr-1",3,"click"],[1,"col-12","md:col-5","flex","align-items-center","justify-content-end"],["styleClass","p-0",3,"rows","totalRecords","rowsPerPageOptions","showJumpToPageDropdown","showPageLinks","onPageChange"],[1,"col-12","md:col-2","flex","align-items-center"],["pButton","","pRipple","","type","button","icon","fa-solid fa-sync",1,"p-button-raised","p-button-text",3,"click"],[1,"ml-1"],[1,"p-fluid","grid","formgrid"],[1,"field","col-12","md:col-3","mb-1"],[1,"p-inputgroup"],["type","text","pInputText","","placeholder","Ch\u1ecdn c\xf4ng tr\xecnh","disabled","",3,"ngModel","ngModelChange"],["type","button","pButton","","pRipple","","icon","pi pi-ellipsis-h",3,"click"],["type","text","pInputText","","placeholder","Nh\u1eadp t\xean tr\u1ea1m",3,"ngModel","ngModelChange"],["type","text","pInputText","","placeholder","Nh\u1eadp m\xe3 tr\u1ea1m (MAC)",3,"ngModel","ngModelChange"],[1,"field","col-12","md:col-3"],[1,"flex","justify-content-between"],["type","button","pButton","","icon","fa-solid fa-undo","pTooltip","\u0110\u1eb7t l\u1ea1i","tooltipPosition","top",1,"mr-1",3,"click"],["type","button","pButton","","icon","fa-solid fa-search","pTooltip","T\xecm ki\u1ebfm","tooltipPosition","top",1,"mr-1",3,"click"],[2,"width","60px","max-width","60px"],["pSortableColumn","name",2,"min-width","200px"],["field","name"],[2,"min-width","50px"],[2,"min-width","150px"],[2,"min-width","100px"],[2,"min-width","200px"],[3,"pSelectableRow"],[1,"text-green-500",2,"min-width","100px"],["class","pi pi-check-circle",4,"ngIf"],[1,"pi","pi-check-circle"],[1,"p-fluid","p-2"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0,1),t.NdJ("resize",function(){return e.onWindowResize()},!1,t.Jf7),t.TgZ(2,"div",2)(3,"div",3)(4,"span",4),t._uU(5),t.qZA(),t.TgZ(6,"button",5),t.NdJ("click",function(){return e.onDestroy()}),t.qZA()(),t.TgZ(7,"div",6,7)(9,"p-table",8),t.NdJ("selectionChange",function(m){return e.currentStation=m}),t.YNc(10,M,14,3,"ng-template",9),t.YNc(11,y,14,0,"ng-template",10),t.YNc(12,O,13,7,"ng-template",11),t.YNc(13,D,2,0,"ng-template",12),t.qZA()()(),t.TgZ(14,"div",13,14)(16,"div",15)(17,"div",16)(18,"button",17),t.NdJ("click",function(){return e.onSubmit()}),t.qZA(),t.TgZ(19,"button",18),t.NdJ("click",function(){return e.onDestroy()}),t.qZA()(),t.TgZ(20,"div",19)(21,"p-paginator",20),t.NdJ("onPageChange",function(m){return e.onPageChange(m)}),t.qZA()(),t.TgZ(22,"div",21)(23,"button",22),t.NdJ("click",function(){return e.onReSync()}),t.qZA(),t.TgZ(24,"span",23),t._uU(25),t.qZA()()()()()),2&n&&(t.xp6(5),t.Oqu(e.title),t.xp6(4),t.Q6J("selection",e.currentStation)("value",e.stations)("scrollable",!0)("loading",e.loading),t.xp6(9),t.Q6J("disabled",!e.currentStation),t.xp6(3),t.Q6J("rows",e.itemsPerPage)("totalRecords",e.totalItems)("rowsPerPageOptions",t.DdM(14,L))("showJumpToPageDropdown",!0)("showPageLinks",!1),t.xp6(4),t.lnq("Displaying ",(e.currentPage-1)*e.itemsPerPage+1,"-",(e.currentPage-1)*e.itemsPerPage+e.itemsPerPage>e.totalItems?e.totalItems:(e.currentPage-1)*e.itemsPerPage+e.itemsPerPage," of ",e.totalItems,""))},directives:[a.Hq,_.H,l.iA,v.jx,u.Fj,o.o,u.JJ,u.On,h.u,l.lQ,l.fz,l.Ei,r.O5,p.D],styles:[""]}),d})()}}]);